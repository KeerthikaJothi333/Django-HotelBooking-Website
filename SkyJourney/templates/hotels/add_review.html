{% extends 'base/base.html' %}

{% block title %}Write a Review{% endblock %}

{% block content %}
<div class="container py-5" style="max-width: 600px;">
    <div class="card shadow-lg border-0">
        <div class="card-body">
            <h3 class="text-center text-primary mb-4">‚≠ê Review Your Stay</h3>
            <p class="text-muted text-center">
                Hotel: <strong>{{ booking.hotel.name }}</strong><br>
                Booking ID: #{{ booking.id }}
            </p>

            <form method="POST" id="reviewForm">
                {% csrf_token %}

                <!-- Star Rating -->
                <div class="mb-4 text-center">
                    <label class="form-label d-block mb-2">Your Rating</label>
                    <div id="star-rating" class="fs-3">
                        <i class="bi bi-star" data-value="1"></i>
                        <i class="bi bi-star" data-value="2"></i>
                        <i class="bi bi-star" data-value="3"></i>
                        <i class="bi bi-star" data-value="4"></i>
                        <i class="bi bi-star" data-value="5"></i>
                    </div>
                    <input type="hidden" name="stars" id="id_stars" required>
                </div>

                <!-- Comment Box -->
                <div class="mb-3">
                    <label for="id_comment" class="form-label">Your Review</label>
                    {{ form.comment }}
                </div>

                <button type="submit" class="btn btn-primary w-100">Submit Review</button>
            </form>
        </div>
    </div>
</div>

<!-- Bootstrap Icons CDN -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">

<!-- JavaScript for star rating -->
<script>
document.addEventListener("DOMContentLoaded", function() {
    const stars = document.querySelectorAll("#star-rating i");
    const hiddenInput = document.getElementById("id_stars");
    let selected = 0;

    stars.forEach(star => {
        star.addEventListener("mouseover", () => highlightStars(star.dataset.value));
        star.addEventListener("mouseout", () => highlightStars(selected));
        star.addEventListener("click", () => {
            selected = star.dataset.value;
            hiddenInput.value = selected;
        });
    });

    function highlightStars(count) {
        stars.forEach((star, i) => {
            if (i < count) {
                star.classList.add("text-warning");
                star.classList.remove("bi-star");
                star.classList.add("bi-star-fill");
            } else {
                star.classList.remove("text-warning");
                star.classList.add("bi-star");
                star.classList.remove("bi-star-fill");
            }
        });
    }
});
</script>

{% endblock %}
